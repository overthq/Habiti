fragment CartDetails on carts {
	id
	user_id
	store_id
	store {
		id
		name
	}
	# Aggregate of cart items in store
	cart_items {
		id
		item_id
		item {
			id
			name
			unit_price
		}
		quantity
	}
}

query Carts($userId: uuid!) {
	carts(where: { user_id: { _eq: $userId } }) {
		...CartDetails
	}
}

query Cart($cartId: uuid!) {
	carts_by_pk(id: $cartId) {
		...CartDetails
	}
}

mutation CreateCart($object: carts_insert_input!) {
	insert_carts_one(object: $object) {
		id
		user_id
	}
}

mutation UpsertItemToCart($object: cart_items_insert_input!) {
	insert_cart_items_one(
		object: $object
		on_conflict: { constraint: cart_items_pkey, update_columns: [quantity] }
	) {
		id
		cart_id
	}
}

mutation RemoveItemFromCart($itemId: uuid!) {
	delete_cart_items_by_pk(id: $itemId) {
		id
	}
}
